C51 COMPILER V9.60.7.0   TIMER                                                             12/03/2023 11:06:02 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\timer.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE MCAL\timer.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\timer.lst) TABS(2) OBJECT(.\Objects\timer.obj)

line level    source

   1          #include "LIB\STD_TYPES.h"
   2          #include "LIB\BIT_MATH.h"
   3          #include "MCAL\DIO_INT.h"
   4          #include "MCAL\timer.h"
   5          #include "MCAL\DIO_REG.h"
   6          
   7          void timer0_init(u8 mode, u16 initial_value) {
   8   1          TMOD &= 0xF0;
   9   1          TMOD |= mode;
  10   1      
  11   1          TH0 = (u8)(initial_value >> 8);
  12   1          TL0 = (u8)initial_value;
  13   1      }
  14          
  15          void timer1_init(u8 mode, u16 initial_value) {
  16   1          TMOD &= 0x0F;
  17   1          TMOD |= (mode << 4);
  18   1      
  19   1          TH1 = (u8)(initial_value >> 8);
  20   1          TL1 = (u8)(initial_value);
  21   1      }
  22          
  23          void timer2_init(u8 mode, u16 initial_value) {
  24   1          T2CON &= 0xF0;
  25   1          T2CON |= mode;
  26   1      
  27   1          RCAP2H = (u8)(initial_value >> 8);
  28   1          RCAP2L = (u8)initial_value;
  29   1      }
  30          void timer0_start() {
  31   1          TR0 = 1;
  32   1      }
  33          
  34          void timer1_start() {
  35   1          TR1 = 1;
  36   1      }
  37          
  38          void timer2_start() {
  39   1          TR2 = 1;
  40   1      }
  41          
  42          void timer0_stop() {
  43   1          TR0 = 0;
  44   1      }
  45          
  46          void timer1_stop() {
  47   1          TR1 = 0;
  48   1      }
  49          
  50          void timer2_stop() {
  51   1          TR2 = 0;
  52   1      }
  53          void delay_ms_timer0(u16 milliseconds) {
  54   1          // Assuming a 12 MHz crystal frequency
C51 COMPILER V9.60.7.0   TIMER                                                             12/03/2023 11:06:02 PAGE 2   

  55   1          // Timer 0 with 16-bit mode, 1 ms = 12,000 counts
  56   1          u16 counts = machine_cycle * milliseconds;
  57   1      
  58   1          timer0_init(TIMER0_MODE1, 65536 - counts);
  59   1          timer0_start();
  60   1      
  61   1          while (TF0 == 0) {} // Wait for overflow flag
  62   1          timer0_stop();
  63   1          TF0 = 0; // Clear the overflow flag
  64   1      }
  65          
  66          void delay_ms_timer1(u16 milliseconds){
  67   1          // Assuming a 12 MHz crystal frequency
  68   1          // Timer 1 with 16-bit mode, 1 ms = 12,000 counts
  69   1          //u16 label_1 = 12 / Crystal_Freq;
  70   1          //u8  label_2 = milliseconds / 1000;  
  71   1          u32 counts = machine_cycle * milliseconds;
  72   1          timer1_init(TIMER1_MODE1,65536 - counts);
  73   1          timer1_start();
  74   1          while (TF1 == 0) {} // Wait for overflow flag
  75   1          timer1_stop();
  76   1          TF1 = 0; // Clear the overflow flag
  77   1          }
  78          void delay_second_timer0(u16 seconds){
  79   1        int i,j;
  80   1        for(i=0;i<seconds;i++){
  81   2          for(j=0;j<20;j++){
  82   3            delay_ms_timer0(50);
  83   3          }
  84   2        }
  85   1      }
  86          void delay_second_timer1(u16 seconds){
  87   1        int i,j;
  88   1        for(i=0;i<seconds;i++){
  89   2          for(j=0;j<20;j++){
  90   3            delay_ms_timer1(50);
  91   3          }
  92   2        }
  93   1      }
*** WARNING C316 IN LINE 93 OF MCAL\timer.c: unterminated conditionals


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    210    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
